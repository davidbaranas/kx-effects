; Generated by kX DSP Editor - microcode dump
name "K-DelayStereo";
copyright "(c) Eugene Gavrilov, 2001-2005";
; NOTE The present DSP microcode dump is protected by the 
; license agreement bundled with the appropriate software 
; package containing this microcode,
; regardless the particular copyright notice is present in the dump.

engine "K-DelayStereo";
created "2009";
guid "413d1ccd-4b74-4e56-ad3e-3811964712d2";

xtramsize 48000

; Registers
	output outL
	output outR
	input inL
	input inR
	
	control Level=1.0
	control DelayL=0.5
	control DelayR=0.5
	control Feedback=0.4
	control Xfeed=0.4
	control TapeSim=0.5
	
	xdelay write wrtL at 0x0;
	xdelay read rdL at 0x0;
	xdelay write wrtR at 24001;
	xdelay read rdR at 24001;
    
    temp scaledelayL
    temp scaledelayR
    temp scaledLoPass

    static XfeedL
    static XfeedR
    static LoPassL
    static LoPassR
    static SmoothDelayL
    static SmoothDelayR
;Code                                         
	
	 exp     ScaledLoPass,TapeSim,7,0
	 interp  ScaledLoPass,0.1,ScaledLoPass,1.0

	 interp  SmoothDelayL,SmoothdelayL,0.00005,DelayL
	 interp  scaledelayL,0x960,SmoothDelayL,0xBB80
	 macints scaledelayL,0x0,scaledelayL,0x800
	 acc3 	 &rdL,  scaledelayL,  &wrtL,  0x0
	 
	 
	 macs    wrtL,InL,LoPAssL,Feedback
	 macs    wrtL,wrtL,LoPassR,Xfeed
	 macs 	 outL, InL, rdL,  Level
	 interp  LoPassL,  LoPassL,  scaledLoPass,  rdL
	 
	 
	 
	 interp  SmoothDelayR,SmoothdelayR,0.00005,DelayR
	 interp  scaledelayR,0x960,SmoothDelayR,0xBB80
	 macints scaledelayR,0x0,scaledelayR,0x800
	 acc3 	 &rdR,  scaledelayR,  &wrtR,  0x0
	 
	 macs    wrtR,InR,LoPAssR,Feedback
	 macs    wrtR,wrtR,LoPassL,Xfeed
	 macs 	 outR, InR, rdR,  Level
	 interp  LoPassR,  LoPassR,  scaledLoPass,  rdR
	 
end
